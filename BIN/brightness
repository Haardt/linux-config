#!/usr/bin/env sh

set -e

path="/sys/class/backlight/intel_backlight"

max=$(sudo cat $path/max_brightness)
current=$(sudo cat $path/brightness)
step=$(( max / 10))

if [ "$1" = "up" ]
then
  new=$(( current + step ))
  [ $new -gt "$max" ] && new=$max

  sudo sh -c "echo $new > $path/brightness"
elif [ $1 = "down" ]
then
  if [ $(( current / ( max / 100 ) )) -le 10 ]
  then
    step=$(( step / 10 ))
  fi

  if [ $(( current / ( max / 100 ) )) -le 1 ]
  then
    step=$(( step / 10 ))
  fi

  new=$(( current - step ))
  [ $new -lt 0 ] && new=0

  sudo sh -c "echo $new > $path/brightness"
fi

